# ุฑุงูููุง ูพุงฺฉุณุงุฒ ู ุจูููโุณุงุฒ ุณุฑูุฑ Amnezia

ุงู ุฑุงูููุง ุดุงูู ุฏุณุชูุฑุงูุนููโูุง ูุงุฒู ุจุฑุง ุฑูุน ูุดฺฉูุงุช ู ุจูููโุณุงุฒ ุณุฑูุฑ Amnezia ุงุณุช.

## ูุดฺฉูุงุช ุจุฑุทุฑู ุดุฏู

### 1. ุฎุทุง `Cannot read properties of null (reading 'connection_uuids')`
- **ุนูุช:** ฺฉุงุฑุจุฑ ุฏุฑ ุฏุชุงุจุณ ูุฌูุฏ ูุฏุงุฑุฏ ุง `connection_uuids` ุชุนุฑู ูุดุฏู
- **ุฑุงูโุญู:** ุงุถุงูู ฺฉุฑุฏู null check ู initialization ุฏุฑ `get_real_subscription_url`

### 2. ูุดฺฉู comment ฺฉุฑุฏู ฺฉุงุฑุจุฑุงู ูููุถ ุดุฏู
- **ุนูุช:** ููุทู ูุงุฏุฑุณุช ูพุฏุง ฺฉุฑุฏู ู comment ฺฉุฑุฏู peer ูุง
- **ุฑุงูโุญู:** ุจูุจูุฏ ุงูฺฏูุฑุชู ูพุฏุง ฺฉุฑุฏู ู comment ฺฉุฑุฏู ฺฉุงูู peer ูุง

### 3. ูุดฺฉู ููฺฏุงูโุณุงุฒ WireGuard
- **ุนูุช:** `wg syncconf` ฺฉุงู ูุณุช
- **ุฑุงูโุญู:** ุงุถุงูู ฺฉุฑุฏู restart ฺฉุงูู WireGuard

## ูุงูโูุง ุฌุฏุฏ

### 1. `cleanup_orphaned_users.js`
ุงุณฺฉุฑูพุช ุงุตู ุจุฑุง ูพุงฺฉุณุงุฒ ฺฉุงุฑุจุฑุงู orphaned

**ุงุณุชูุงุฏู:**
```bash
# ุจุฑุฑุณ ูุถุนุช ููฺฏุงูโุณุงุฒ
node cleanup_orphaned_users.js check

# ุญุฐู ฺฉุงุฑุจุฑุงู orphaned
node cleanup_orphaned_users.js cleanup
```

### 2. `auto_cleanup.js`
ุงุณฺฉุฑูพุช ุฎูุฏฺฉุงุฑ ุจุฑุง ูพุงฺฉุณุงุฒ

**ุงุณุชูุงุฏู:**
```bash
node auto_cleanup.js
```

## ุชูุธูุงุช Cron Job

### ูพุงฺฉุณุงุฒ ุฎูุฏฺฉุงุฑ ูุฑ 5 ุฏููู
```bash
# ุงุถุงูู ฺฉุฑุฏู ุจู crontab
crontab -e

# ุงุถุงูู ฺฉุฑุฏู ุงู ุฎุท:
*/5 * * * * cd /path/to/amnezia_wrapper && node auto_cleanup.js >> /var/log/amnezia_cleanup.log 2>&1
```

### ูพุงฺฉุณุงุฒ ฺฉุงูู ูุฑ ุณุงุนุช
```bash
# ุงุถุงูู ฺฉุฑุฏู ุจู crontab
0 * * * * cd /path/to/amnezia_wrapper && node cleanup_orphaned_users.js cleanup >> /var/log/amnezia_cleanup.log 2>&1
```

## ูุงูุชูุฑูฺฏ

### ุจุฑุฑุณ ูุงฺฏโูุง
```bash
# ุจุฑุฑุณ ูุงฺฏโูุง ูพุงฺฉุณุงุฒ
tail -f /var/log/amnezia_cleanup.log

# ุจุฑุฑุณ ูุงฺฏโูุง ุณุฑูุฑ
pm2 logs server --raw --lines 100
```

### ุจุฑุฑุณ ูุถุนุช ููฺฏุงูโุณุงุฒ
```bash
cd /path/to/amnezia_wrapper
node cleanup_orphaned_users.js check
```

## ุนุจโุงุจ

### ูุดฺฉู 1: ุฎุทุง ุงุชุตุงู ุจู ุฏุชุงุจุณ
```bash
# ุจุฑุฑุณ ูุถุนุช MongoDB
systemctl status mongod

# ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ MongoDB
systemctl restart mongod
```

### ูุดฺฉู 2: ุฎุทุง Docker
```bash
# ุจุฑุฑุณ ูุถุนุช ฺฉุงูุชูุฑ Amnezia
docker ps | grep amnezia

# ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ ฺฉุงูุชูุฑ
docker restart amnezia-awg
```

### ูุดฺฉู 3: ุฎุทุง WireGuard
```bash
# ุจุฑุฑุณ ูุถุนุช WireGuard
wg show

# ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ WireGuard
wg-quick down wg0
wg-quick up wg0
```

## ุจูููโุณุงุฒ ุนููฺฉุฑุฏ

### 1. ฺฉุงูุด ูุตุฑู RAM
- ูพุงฺฉุณุงุฒ ููุธู ฺฉุงุฑุจุฑุงู orphaned
- ูุญุฏูุฏ ฺฉุฑุฏู ุชุนุฏุงุฏ ฺฉุงุฑุจุฑุงู ููุฒูุงู

### 2. ุจูุจูุฏ ููฺฏุงูโุณุงุฒ
- ฺฉุงูุด ุฒูุงู sync ุงุฒ 90 ุซุงูู ุจู 30 ุซุงูู
- ุงุถุงูู ฺฉุฑุฏู restart ฺฉุงูู WireGuard

### 3. ูุงูุชูุฑูฺฏ ุจูุชุฑ
- ุงุถุงูู ฺฉุฑุฏู ูุงฺฏโูุง ุชูุตู
- ุจุฑุฑุณ ููุธู ูุถุนุช ููฺฏุงูโุณุงุฒ

## ูฺฉุงุช ููู

โ๏ธ **ูุดุฏุงุฑ:** ููุดู ูุจู ุงุฒ ุงุฌุฑุง ูพุงฺฉุณุงุฒุ backup ุจฺฏุฑุฏ

๐ **ุชูุตู:** ูุงฺฏโูุง ุฑุง ุจู ุทูุฑ ููุธู ุจุฑุฑุณ ฺฉูุฏ

๐ **ุงููุช:** ูุทูุฆู ุดูุฏ ฺฉู ุฏุณุชุฑุณโูุง ููุงุณุจ ุชูุธู ุดุฏูโุงูุฏ

## ูพุดุชุจุงู

ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุดฺฉู:
1. ูุงฺฏโูุง ุฎุทุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. ูุถุนุช ููฺฏุงูโุณุงุฒ ุฑุง ฺฺฉ ฺฉูุฏ
3. ุงุชุตุงู ุจู ุฏุชุงุจุณ ู Docker ุฑุง ุชุณุช ฺฉูุฏ
4. ุฏุฑ ุตูุฑุช ูุงุฒุ ุณุฑูุฑ ุฑุง restart ฺฉูุฏ
